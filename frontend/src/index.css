@tailwind base;
@tailwind components;
@tailwind utilities;

/* Brand palette for backgrounds (dark-mode ready: override in .dark) */
:root {
  --brand-bg: #F7F8FA;
  --brand-navy: #3E5667;
  --brand-accent: #6FA8DC;
  --brand-red: #E57373;
}

/* Visible dotted grid – brand navy ~6% – adds depth without noise */
:root {
  --bg-pattern: url("data:image/svg+xml,%3Csvg width='16' height='16' viewBox='0 0 16 16' xmlns='http://www.w3.org/2000/svg'%3E%3Ccircle cx='2' cy='2' r='0.6' fill='%233E5667' fill-opacity='0.06'/%3E%3Ccircle cx='10' cy='2' r='0.6' fill='%233E5667' fill-opacity='0.06'/%3E%3Ccircle cx='2' cy='10' r='0.6' fill='%233E5667' fill-opacity='0.06'/%3E%3Ccircle cx='10' cy='10' r='0.6' fill='%233E5667' fill-opacity='0.06'/%3E%3C/svg%3E");
}

@layer base {
  html {
    overflow-x: hidden;
  }
  body {
    color: var(--brand-navy);
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    font-family: Inter, ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
    min-height: 100vh;
    background-color: var(--brand-bg);
    overflow-x: hidden;
    max-width: 100vw;
  }
}

/* Single full-bleed page background — fixed behind all content, no section seams */
.page-bg-global {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  z-index: -1;
  background-color: var(--brand-bg);
  background-image:
    radial-gradient(ellipse 150% 120% at 50% -25%, rgba(111, 168, 220, 0.12) 0%, rgba(111, 168, 220, 0.03) 40%, transparent 65%),
    linear-gradient(to top, rgba(62, 86, 103, 0.07) 0%, rgba(62, 86, 103, 0.02) 35%, transparent 55%),
    var(--bg-pattern);
  background-size: 100% 100%, 100% 100%, 16px 16px;
  background-position: 0 0, 0 0, 0 0;
  background-repeat: no-repeat, no-repeat, repeat;
}

/* Isolate 改善ポイント section so it always shows its own background */
.feature-highlight {
  background: transparent !important;
  backdrop-filter: none !important;
  -webkit-backdrop-filter: none !important;
}
.feature-highlight::before,
.feature-highlight::after {
  display: none !important;
}

/* Readability: card contrast — 今まで = subdued, TESTREPORT = main focus */
/* 今まで card: 引き立て役 — より控えめ */
.feature-highlight .feature-highlight-card:not(.feature-highlight-card-after) {
  background: rgba(248, 250, 252, 0.85) !important;
  border: 1px solid rgba(226, 232, 240, 0.6) !important;
  box-shadow: 0 4px 16px rgba(0, 0, 0, 0.04) !important;
}
.feature-highlight .feature-highlight-card:not(.feature-highlight-card-after) li,
.feature-highlight .feature-highlight-card:not(.feature-highlight-card-after) span:not(.feature-highlight-pill) {
  color: #94a3b8 !important;
}
.feature-highlight .feature-highlight-card:not(.feature-highlight-card-after) .feature-highlight-pill {
  background: rgba(203, 213, 225, 0.5) !important;
  color: #64748b !important;
}
.feature-highlight .feature-highlight-card:not(.feature-highlight-card-after) li span.flex-shrink-0 {
  color: #cbd5e1 !important;
}

/* TESTREPORT card: 主役 — 強いコントラスト・青で目立たせる */
.feature-highlight .feature-highlight-card-after {
  background: rgba(239, 246, 255, 0.95) !important;
  border: 1px solid rgba(96, 165, 250, 0.5) !important;
  box-shadow: 0 10px 32px rgba(59, 130, 246, 0.12) !important;
}
.feature-highlight .feature-highlight-card-after li,
.feature-highlight .feature-highlight-card-after span:not(.feature-highlight-pill) {
  color: #0f172a !important;
}
.feature-highlight .feature-highlight-card-after .feature-highlight-pill {
  background: rgba(59, 130, 246, 0.28) !important;
  color: #1d4ed8 !important;
}
.feature-highlight .feature-highlight-card-after li span.flex-shrink-0 {
  color: var(--brand-accent) !important;
}

.feature-highlight h2,
.feature-highlight h3,
.feature-highlight h4 {
  color: #1f2a37 !important;
}
.feature-highlight p {
  color: #334155 !important;
}

/* Full-bleed section overlay (no clipping by max-w); use gradient fades, low opacity */
/* Use 100% so we don't overflow viewport (100vw includes scrollbar and causes horizontal scroll) */
.section-overlay {
  position: absolute;
  inset: 0;
  z-index: -1;
  width: 100%;
  pointer-events: none;
}

@layer components {
  .btn {
    @apply px-4 py-2.5 min-h-[44px] sm:min-h-0 rounded-xl font-medium transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2;
  }
  
  .btn-primary {
    @apply btn bg-primary-600 text-white hover:bg-primary-700 focus:ring-primary-500 shadow-sm;
  }
  
  .btn-secondary {
    @apply btn bg-slate-100 text-slate-700 hover:bg-slate-200 focus:ring-slate-400;
  }
  
  .btn-danger {
    @apply btn bg-red-600 text-white hover:bg-red-700 focus:ring-red-500;
  }
  
  .btn-success {
    @apply btn bg-emerald-600 text-white hover:bg-emerald-700 focus:ring-emerald-500;
  }
  
  .input {
    @apply w-full px-4 py-2.5 border border-slate-200 rounded-xl bg-slate-50/50 focus:outline-none focus:ring-2 focus:ring-primary-500/20 focus:border-primary-400 focus:bg-white transition-colors;
  }
  
  .textarea {
    @apply w-full px-4 py-2.5 border border-slate-200 rounded-xl bg-slate-50/50 focus:outline-none focus:ring-2 focus:ring-primary-500/20 focus:border-primary-400 focus:bg-white transition-colors resize-none;
  }
  
  .select {
    @apply w-full px-4 py-2.5 border border-slate-200 rounded-xl bg-white focus:outline-none focus:ring-2 focus:ring-primary-500/20 focus:border-primary-400 transition-colors;
  }
  
  .label {
    @apply block text-sm font-medium text-slate-700 mb-1.5;
  }
  
  .card {
    @apply bg-white rounded-2xl shadow-sm border border-slate-200/80 p-6;
  }
  
  .badge {
    @apply inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium;
  }
  
  .badge-pass {
    @apply badge bg-green-100 text-green-800;
  }
  
  .badge-fail {
    @apply badge bg-red-100 text-red-800;
  }
  
  .badge-blocked {
    @apply badge bg-yellow-100 text-yellow-800;
  }
  
  .badge-skipped {
    @apply badge bg-gray-100 text-gray-800;
  }

  /* ---------- Background system (brand palette only) – clear depth & rhythm ---------- */

  /* Hero: visible glow orbs + mesh so product feels “in space” */
  .bg-hero {
    position: relative;
    isolation: isolate;
    background-image:
      radial-gradient(ellipse 70% 55% at 75% 35%, rgba(111, 168, 220, 0.22) 0%, rgba(111, 168, 220, 0.06) 45%, transparent 70%),
      radial-gradient(ellipse 55% 50% at 25% 55%, rgba(62, 86, 103, 0.1) 0%, transparent 55%),
      radial-gradient(ellipse 100% 80% at 50% 20%, rgba(111, 168, 220, 0.12) 0%, transparent 50%);
    background-size: 100% 100%;
    background-position: 0 0;
    background-repeat: no-repeat;
  }
  /* Blurred glow blob behind hero content */
  .bg-hero::before {
    content: '';
    position: absolute;
    z-index: 0;
    top: 20%;
    right: 10%;
    width: min(80vw, 420px);
    height: min(80vw, 420px);
    border-radius: 50%;
    background: radial-gradient(circle, rgba(111, 168, 220, 0.35) 0%, rgba(111, 168, 220, 0.08) 45%, transparent 70%);
    filter: blur(56px);
    pointer-events: none;
  }
  .bg-hero::after {
    content: '';
    position: absolute;
    z-index: 0;
    inset: 0;
    background-image: var(--bg-pattern);
    background-size: 16px 16px;
    opacity: 0.7;
    pointer-events: none;
  }
  .bg-hero > * {
    position: relative;
    z-index: 1;
  }

  /* Section: clear “panel” – frosted white with soft top fade */
  .bg-section {
    background-color: rgba(255, 255, 255, 0.72);
    background-image:
      linear-gradient(to bottom, rgba(247, 248, 250, 0.9) 0%, transparent 25%),
      linear-gradient(to top, rgba(247, 248, 250, 0.4) 0%, transparent 15%);
  }

  /* Section alternate: visible navy tint for rhythm */
  .bg-section-alt {
    background-color: rgba(62, 86, 103, 0.055);
    background-image:
      linear-gradient(to bottom, rgba(62, 86, 103, 0.04) 0%, transparent 20%),
      linear-gradient(to top, rgba(62, 86, 103, 0.06) 0%, transparent 25%);
  }

  /* Soft: clear “pool” of light (stack area, footer) */
  .bg-soft {
    background-color: rgba(247, 248, 250, 0.85);
    background-image:
      radial-gradient(ellipse 100% 70% at 50% 20%, rgba(111, 168, 220, 0.12) 0%, transparent 55%),
      linear-gradient(to bottom, transparent 0%, rgba(62, 86, 103, 0.03) 100%);
  }

  /* CTA: strong gradient band – clearly its own block */
  .bg-cta {
    background-image: linear-gradient(145deg, rgba(62, 86, 103, 0.11) 0%, rgba(111, 168, 220, 0.18) 45%, rgba(62, 86, 103, 0.08) 100%);
    background-color: rgba(247, 248, 250, 0.5);
  }
}

/* Dark mode: gradients adapt, no pure white (enable when .dark exists) */
.dark body {
  --brand-bg: #1a1f24;
  background-image:
    radial-gradient(ellipse 150% 120% at 50% -25%, rgba(111, 168, 220, 0.18) 0%, rgba(111, 168, 220, 0.05) 40%, transparent 65%),
    linear-gradient(to top, rgba(62, 86, 103, 0.14) 0%, transparent 50%),
    var(--bg-pattern);
}
.dark .bg-section {
  background-color: rgba(62, 86, 103, 0.12);
  background-image: linear-gradient(to bottom, rgba(0, 0, 0, 0.08), transparent 25%);
}
.dark .bg-section-alt {
  background-color: rgba(111, 168, 220, 0.08);
  background-image: linear-gradient(to top, rgba(62, 86, 103, 0.1) 0%, transparent 25%);
}
.dark .bg-soft {
  background-color: rgba(30, 38, 44, 0.7);
  background-image: radial-gradient(ellipse 100% 70% at 50% 20%, rgba(111, 168, 220, 0.14) 0%, transparent 55%);
}
.dark .bg-cta {
  background-image: linear-gradient(145deg, rgba(62, 86, 103, 0.2) 0%, rgba(111, 168, 220, 0.22) 45%, rgba(62, 86, 103, 0.12) 100%);
  background-color: rgba(0, 0, 0, 0.15);
}
.dark .bg-hero {
  background-image:
    radial-gradient(ellipse 70% 55% at 75% 35%, rgba(111, 168, 220, 0.28) 0%, transparent 70%),
    radial-gradient(ellipse 55% 50% at 25% 55%, rgba(62, 86, 103, 0.15) 0%, transparent 55%),
    radial-gradient(ellipse 100% 80% at 50% 20%, rgba(111, 168, 220, 0.15) 0%, transparent 50%);
}
.dark .bg-hero::before {
  background: radial-gradient(circle, rgba(111, 168, 220, 0.4) 0%, transparent 70%);
}

@keyframes sheet-slide-in {
  from { transform: translateX(100%); }
  to { transform: translateX(0); }
}
.sheet-panel {
  animation: sheet-slide-in 0.2s ease-out;
}

/* Projects & cards: fade-in-up and hover */
@keyframes fade-in-up {
  from {
    opacity: 0;
    transform: translateY(12px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}
.animate-fade-in-up {
  animation: fade-in-up 0.4s ease-out both;
}
@keyframes modal-in {
  from {
    opacity: 0;
    transform: scale(0.96);
  }
  to {
    opacity: 1;
    transform: scale(1);
  }
}
.animate-modal-in {
  animation: modal-in 0.2s ease-out;
}

/* Scroll-triggered animations (use with .in-view from useInView) */
.scroll-animate {
  opacity: 0;
  transform: translateY(24px);
  transition: opacity 0.6s ease-out, transform 0.6s ease-out;
}
.scroll-animate.in-view {
  opacity: 1;
  transform: translateY(0);
}

.scroll-animate-left {
  opacity: 0;
  transform: translateX(-24px);
  transition: opacity 0.6s ease-out, transform 0.6s ease-out;
}
.scroll-animate-left.in-view {
  opacity: 1;
  transform: translateX(0);
}

.scroll-animate-right {
  opacity: 0;
  transform: translateX(24px);
  transition: opacity 0.6s ease-out, transform 0.6s ease-out;
}
.scroll-animate-right.in-view {
  opacity: 1;
  transform: translateX(0);
}

.scroll-animate-scale {
  opacity: 0;
  transform: scale(0.96);
  transition: opacity 0.5s ease-out, transform 0.5s ease-out;
}
.scroll-animate-scale.in-view {
  opacity: 1;
  transform: scale(1);
}

/* Stagger delays for children */
.scroll-stagger-1 { transition-delay: 0.1s; }
.scroll-stagger-2 { transition-delay: 0.2s; }
.scroll-stagger-3 { transition-delay: 0.3s; }
.scroll-stagger-4 { transition-delay: 0.4s; }

/* Stacking cards: each card slides up, scales in, and “lands” with shadow */
.stack-card {
  opacity: 0;
  transform: translateY(80px) scale(0.92) rotateX(12deg);
  transition:
    opacity 0.7s cubic-bezier(0.22, 1, 0.36, 1),
    transform 0.7s cubic-bezier(0.22, 1, 0.36, 1),
    box-shadow 0.6s ease-out;
  box-shadow:
    0 24px 48px -12px rgb(62 86 103 / 0.15),
    0 12px 24px -8px rgb(62 86 103 / 0.08);
  transform-origin: center bottom;
}
.stack-card.in-view {
  opacity: 1;
  transform: translateY(0) scale(1) rotateX(0);
  box-shadow:
    0 8px 16px -4px rgb(62 86 103 / 0.06),
    0 4px 8px -2px rgb(62 86 103 / 0.04);
}
.stack-card-delay-0 { transition-delay: 0s; }
.stack-card-delay-1 { transition-delay: 0.22s; }
.stack-card-delay-2 { transition-delay: 0.44s; }

/* Mobile responsive utilities */
@layer utilities {
  .container-responsive {
    @apply container mx-auto px-4 sm:px-6 lg:px-8;
  }
  
  .text-responsive {
    @apply text-sm sm:text-base;
  }
  
  .heading-responsive {
    @apply text-xl sm:text-2xl lg:text-3xl;
  }
}
